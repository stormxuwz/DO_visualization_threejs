<!DOCTYPE html>
<head>
	<title>Lake Erie DO visualization</title>
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
	<script type="text/javascript" src="http://mbostock.github.com/d3/d3.js?1.29.1"></script>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script type="text/javascript" src="js/jquery.simple-dtpicker.js"></script>

	<link type="text/css" href="css/jquery.simple-dtpicker.css" rel="stylesheet" />
	<style type="text/css">
	
html, body, #map {
  width: 85%;
  height: 85%;
  margin: 0;
  padding: 0;
}

.stations, .stations svg {
  position: absolute;
}

.stations svg {
  width: 50px;
  height: 50px;
  padding-right: 100px;
  font: 10px sans-serif;
}

.stations circle {
  fill: brown;
  stroke: black;
  stroke-width: 1.5px;
}
	</style>

</head>

<body>

<h3>Select Time Visualization</h3>
<input type="text" name="date18" value="">

<script type="text/javascript">
	$(function(){
		$('*[name=date18]').appendDtpicker({
			"onShow": function(handler){
				window.alert('Picker is shown!');
			},
			"onHide": function(handler){
				window.alert('Picker is hidden!');
			},
			"minuteInterval": 15
		});
	});
</script>

<div id="map"></div>
<script type="text/javascript">

$('*[name=date18]').on('input',function(){
	 console.log($(this).val());
});

// Create Google Map
var map = new google.maps.Map(d3.select("#map").node(), {
	zoom: 9,
	center: new google.maps.LatLng(42.054393, -81.386539),  
	mapTypeId: google.maps.MapTypeId.TERRAIN
});

var da;

$('*[name=date]').on('input', function() { 
    $(this).val() // get the current value of the input field.
});

// Station Geo locations
var station_position={
	"10523446":[-81.20418,42.42676],
	"10523447":[-81.75660,41.97501],
	"10523439":[-81.01057,42.07898],
	"10523450":[-81.57354,42.10761],
	"10523446":[-81.20418,42.42676],
	// "10523446":[-81.20418,42.42676],
	// "10523446":[-81.20418,42.42676],
	// "10523446":[-81.20418,42.42676],
	// "10523446":[-81.20418,42.42676],
	// "10523446":[-81.20418,42.42676],
}




var overlay = new google.maps.OverlayView();
var marker;
var layer;

overlay.onAdd = function() {
	layer = d3.select(this.getPanes().overlayLayer).append("div")
        .attr("class", "stations");

    overlay.draw = function() {
	      var projection = this.getProjection(),
	          padding =10;

	      marker = layer.selectAll("svg")
	          .data(d3.entries(station_position))
	          .each(transform) // update existing markers
	        .enter().append("svg:svg")
	          .each(transform)
	          .attr("class", "marker");

	      marker.append("svg:circle")
	          .attr("r", 7)
	          .attr("cx", padding)
	          .attr("cy", padding);

	      marker.append("svg:text")
	          .attr("x", padding + 7)
	          .attr("y", padding)
	          .attr("dy", ".31em")
	          .text(function(d) {return d.No; });
          
	      function transform(d) {
	        d = new google.maps.LatLng(d.value[1], d.value[0]);
	        d = projection.fromLatLngToDivPixel(d);
	        // console.log(d.y);
	        return d3.select(this)
	            .style("left", (d.x - padding) + "px")
	            .style("top", (d.y - padding) + "px");
	      }
   	};
}
overlay.setMap(map);

var dummyData=[20,9,11,8];

d3.select(overlay.getPanes().overlayLayer)
	.selectAll("circle")
	.data(dummyData)
	.transition()
	.duration(500)
	.attr("r",function(d){return d;});
		

</script>

</body>
</html>